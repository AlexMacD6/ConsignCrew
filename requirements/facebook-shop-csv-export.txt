Facebook Shop CSV Export Feature Requirements

Overview:
Create a CSV export endpoint at treasurehub.club/fbshop.csv that exports all relevant listing details for Facebook Shop upload.

Requirements:

1. URL Access:
   - Primary URL: treasurehub.club/fbshop.csv
   - Should redirect to CSV download or provide instructions
   - Must be accessible to admin users

2. CSV Format Requirements:
   - Must include all Facebook Shop required fields:
     * id (listing ID)
     * title (product title)
     * description (product description)
     * price (formatted as currency)
     * condition (new/used/refurbished)
     * brand (product brand)
     * availability (in stock)
     * category (product category)
     * subcategory (product subcategory)
     * gtin (Global Trade Item Number)
     * mpn (Manufacturer Part Number)
     * image_url (primary image)
     * additional_image_url_1 through additional_image_url_8
     * video_url (if available)
     * shipping_weight (in pounds)
     * shipping_length, shipping_width, shipping_height (in cm)
     * seller_name, seller_email
     * created_at, updated_at (timestamps)

3. Data Source:
   - Only include listings where facebookShopEnabled = true
   - Only include listings with status = "active"
   - Include user information (name, email) for seller details
   - Extract image URLs from photos object (hero, back, proof, additional)
   - Use Facebook-specific fields when available (facebookBrand, facebookCondition, facebookGtin)

4. Authentication & Security:
   - Require admin authentication
   - Validate user permissions before allowing export
   - Log export activity for audit purposes

5. File Generation:
   - Generate proper CSV format with headers
   - Handle special characters and commas in text fields
   - Set appropriate Content-Type and Content-Disposition headers
   - Include timestamp in filename

6. Error Handling:
   - Graceful handling of missing data
   - Clear error messages for authentication failures
   - Fallback values for optional fields

7. Performance:
   - Efficient database queries
   - Handle large datasets appropriately
   - Consider pagination for very large exports

8. Admin Integration:
   - Add export link to admin dashboard
   - Provide clear instructions for usage
   - Show export status and history

Implementation Status:
- ✅ Basic endpoint structure created
- ✅ URL routing implemented (treasurehub.club/fbshop.csv)
- ✅ CSV format specification defined
- ✅ Admin dashboard integration added
- ✅ Instructions endpoint working
- ⚠️ Database connection needs verification
- ⚠️ Authentication system needs configuration
- ⚠️ Full CSV generation needs debugging

Next Steps:
1. Debug database connection issues
2. Configure authentication properly
3. Test CSV generation with real data
4. Add export logging and monitoring
5. Implement error handling and validation
6. Add export history and status tracking

Technical Notes:
- Uses Prisma ORM for database queries
- BetterAuth for authentication
- Next.js API routes for endpoint implementation
- CSV generation handles proper escaping and formatting
- Supports Facebook Shop's bulk upload format 